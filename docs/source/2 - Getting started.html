<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<title>2 - Getting started Document</title>

	<link rel="stylesheet" href="../../css/style.css">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1.4">
	<meta name="generator" content="appledoc 2.2.1 (build 1333)">
</head>
<body class="appledoc">
	<header>
		<div class="container" class="hide-in-xcode">
			
			<h1 id="library-title">
				<a href="../../index.html">SensePlatform </a>
			</h1>

			<p id="developer-home">
				<a href="../../index.html">SenseLabs</a>
			</p>
			
		</div>
	</header>

	<aside>
		<div class="container">
			<nav>
				<ul id="header-buttons" role="toolbar">
					<li><a href="../../index.html">Home</a></li>
				</ul>
			</nav>
		</div>
	</aside>

	<article>
		<div id="overview-contents" class="container">
			<div id="content">
				<main role="main">
					<h1 class="title">2 - Getting started Document</h1>

					<h1>Getting started</h1>

<h2>Installation</h2>

<p>The xcode project is setup as a static library. That means you can either compile the project and link against it, or add it as a cross-reference project in Xcode. The latter is explained below. See also this apple keynote.</p>

<ol>
<li>Download the latest released library from GitHub.</li>
<li>Make sure the library project is not opened in Xcode (not even as a sub project in another project), open your project and drag the library&rsquo;s .xcodeproject file on top of your own project in xcode</li>
<li>Add the library target to the &ldquo;Target dependencies&rdquo;. Select your project in the project navigator, select your target and go to the tab &ldquo;Build phases&rdquo;. In &ldquo;Target Dependencies&rdquo; add the Sense Platform</li>
<li>Add the library to &ldquo;Link binary with libraries&rdquo;: This can be done in &ldquo;Build phases&rdquo;->&ldquo;Link binary with libraries&rdquo;.</li>
<li>Include at least the following frameworks in &ldquo;Link binary with libraries&rdquo;

<ul>
<li>CoreLocation</li>
<li>CoreMotion</li>
<li>CoreAudio</li>
<li>AVFoundation</li>
<li>AudioToolbox</li>
<li>CoreTelephony</li>
<li>SystemConfiguration</li>
</ul>
</li>
<li>Add the <code>-ObjC</code> and <code>-all_load</code> flag to your linker flags (see the Apple guide)</li>
<li>In your delegate at startup put <code>[CSSensePlatform initialize];</code> and the necesarry import: <code>#import &lt;SensePlatform/CSSensePlatform.h&gt;</code></li>
<li>In your delegate&rsquo;s willTeminate add <code>[CSSensePlatform willTerminate]</code>;</li>
</ol>


<p>The sense library is allowed to run in background mode only if it is using Appleâ€™s location services.
Apple only allows applications to sense in the background if the position sensor is enabled, it does not matter with what accuracy.
To do this, enable the location sensor <code>[[CSSettings sharedSettings] setSensor kCSSENSOR_LOCATION enabled:YES];</code>,
and also add to your <code>info.plist</code> file the <code>UIBackgroundModes</code>:</p>

<ul>
<li>&ldquo;App registers for location updates&rdquo;</li>
<li>and if you are using the noise sensor also add &ldquo;App plays audio&rdquo;.</li>
</ul>


<p>Note that from iOS 8 onwards you will also need to set NSLocationAlwaysUsageDescription in Info.plist because otherwise the app will not ask for permission. This is a text that is displayed in the dialog box asking the user for permission to use the location even when running in the backgroud.</p>

<h2>Using the library</h2>

<p>Below you will find some examples for using the library for common tasks.</p>

<h3>Initialization</h3>

<pre><code>- (void) initExample {

    //Use the settings singleton to change the settings for sensors
    CSSettings* settings = [CSSettings sharedSettings];

    //Set the credentials to log in to CommonSense with an existing account
    [CSSensePlatform loginWithUser:@"username" andPassword:@"password"];

    //Some settings
    //Set location accuracy to 100 meters
    [settings setSettingType:kCSSettingTypeLocation setting:kCSLocationSettingAccuracy value:@"100"];

    //sample every 60 seconds the motion sensors
    [settings setSettingType:kCSSettingTypeSpatial setting:kCSSpatialSettingInterval value:@"60"];

    //sample every 60 seconds the ambience sensors.
    [settings setSettingType:kCSSettingTypeAmbience setting:kCSAmbienceSettingInterval value:@"60"];

    //Upload every 15 minutes to CommonSense
    [settings setSettingType:kCSSettingTypeGeneral setting:kCSGeneralSettingUploadInterval value:@"900"];

    //Enable some sensors
    //Need the location sensor to run in the background
    [settings setSensor:kCSSENSOR_LOCATION enabled:YES];
    [settings setSensor:kCSSENSOR_BATTERY enabled:YES];
    [settings setSensor:kCSSENSOR_NOISE enabled:YES];
    [settings setSensor:kCSSENSOR_ACCELEROMETER enabled:YES];

    //Listen to data from the sensors
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(newData:) name:kCSNewSensorDataNotification   object:nil];

    //Use this to enable/disable the whole sense platform
    [settings setSettingType:kCSSettingTypeGeneral setting:kCSGeneralSettingSenseEnabled value:kCSSettingYES];
}
</code></pre>

<h3>Getting data from the library</h3>

<pre><code>- (void) getDataExample {
    //Retrieve the last 5 data points from the Location sensor, the sensor doesn't have to be associated with this device
    NSArray* data = [CSSensePlatform  getDataForSensor:@"Location" onlyFromDevice:NO nrLastPoints:5];
}
</code></pre>

<h3>Listening to new sensor data</h3>

<pre><code>- (void) newData:(NSNotification*)notification {
    NSString* sensor = notification.object;
    //Look for battery sensor
    if ([sensor isEqualToString:kCSSENSOR_BATTERY]) {
        //extract value
        NSDictionary* data = [[notification.userInfo objectForKey:@"value"] JSONValue];    
    }    
}
</code></pre>

<p>If you would like to understand a bit more about how to use the app, please read API and Architecture overview.</p>

					<footer>
						<div class="footer-copyright">
							
							<p class="copyright">Copyright &copy; 2015 SenseLabs. All rights reserved. Updated: 2015-08-24</p>
							
							
							<p class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.2.1 (build 1333)</a>.</p>
							
						</div>
					</footer>
				</main>
			</div>
		</div>
	</article>

	<script src="../../js/script.js"></script>
</body>
</html>